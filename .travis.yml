language: cpp
sudo: required
dist: xenial
addons:
  apt:
    packages:
      - gfortran
      - mpich
      - libmpich-dev
      - libhdf5-mpich-dev
    config:
      retries: true
cache:
  directories:
    - $HOME/nndc_hdf5
    - $HOME/endf-b-vii.1
env:
  global:
    - HDF5_ROOT=/usr
    - OMP_NUM_THREADS=2
    - OPENMC_CROSS_SECTIONS=$HOME/nndc_hdf5/cross_sections.xml
    - OPENMC_ENDF_DATA=$HOME/endf-b-vii.1

before_script:
  - bash vendor/openmc/tools/ci/download-xs.sh
  - bash ci/patch_singlerod_rea.sh

install:
  - bash ci/cmake_singlerod.sh
  - bash ci/build_singlerod.sh

script:
  - bash ci/test_singlerod_nek5000.sh
  - bash ci/test_singlerod_openmc.sh
  - bash ci/test_singlerod_openmc_nek5000.sh
  - bash ci/test_singlerod_openmc_heat_surrogate.sh
